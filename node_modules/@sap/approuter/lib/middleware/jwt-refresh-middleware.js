'use strict';

var refreshToken = require('../passport/jwt-refresh').refreshToken;
var urlUtils = require('../utils/url-utils');

module.exports = function refreshJwtMiddleware(req, res, next) {
  if (!req.session || !req.session.user || req.session.jwtRefreshStarted) {
    return next();
  }
  refreshToken(req.app, req.session, urlUtils.getAppRouterHost(req));
  next();
};
